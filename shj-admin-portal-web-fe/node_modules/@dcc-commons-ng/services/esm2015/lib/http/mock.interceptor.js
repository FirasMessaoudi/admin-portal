/*
 * Copyright (c) 2019 ELM. All rights reserved.
 */
import { __decorate, __metadata, __param } from "tslib";
import { Inject, Injectable } from '@angular/core';
import { HttpResponse } from '@angular/common/http';
import { of } from 'rxjs';
import { delay, dematerialize, materialize, mergeMap } from 'rxjs/operators';
import { Logger } from '../logging/logging.service';
const log = new Logger('MockInterceptor');
let MockInterceptor = class MockInterceptor {
    constructor(environment) {
        this.environment = environment;
    }
    intercept(request, next) {
        // if mock is not enabled or we are not in dev environment, then do nothing
        if (!this.environment.mock || !this.environment.dev) {
            return next.handle(request);
        }
        log.debug('################## Mock is enabled');
        // array in local storage for registered users
        let users = JSON.parse(localStorage.getItem('users')) || [];
        // wrap in delayed observable to simulate server api call
        return of(null).pipe(mergeMap(() => {
            // authenticate
            if (request.url.indexOf('/api/auth/login') != -1 && request.method === 'POST') {
                // if login details are valid return 200 OK with user details and fake jwt token
                let body = {
                    authorities: [{ "authority": "DQS_ADMIN" }],
                    principal: "admin",
                    name: "admin"
                };
                return of(new HttpResponse({ status: 200, body: body }));
            }
            // logout
            if (request.url.indexOf('/api/auth/logout') != -1 && request.method === 'POST') {
                // if login details are valid return 200 OK with user details and fake jwt token
                return of(new HttpResponse({ status: 200, body: 'true' }));
            }
            // get users
            if (request.url.indexOf('/api/users/list') != -1 && request.method === 'GET') {
                // check for fake auth token in header and return users if valid, this security is implemented server side in a real application
                users = JSON.parse('{"content":[{"id":21,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444444,"userName":"qweqwe","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251767000,"authorities":[{"id":21,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":22,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444445,"userName":"qweqwer","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251787000,"authorities":[{"id":22,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":23,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444446,"userName":"qweqwerq","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251908000,"authorities":[{"id":23,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":24,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444447,"userName":"qweqwerw","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251909000,"authorities":[{"id":24,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":25,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444448,"userName":"qweqwere","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251909000,"authorities":[{"id":25,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":26,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444449,"userName":"qweqwerr","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251909000,"authorities":[{"id":26,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":27,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444450,"userName":"qweqwert","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251909000,"authorities":[{"id":27,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":28,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444452,"userName":"qweqweru","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251910000,"authorities":[{"id":28,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":29,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444451,"userName":"qweqwery","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251910000,"authorities":[{"id":29,"authority":"DQS_USER"}],"tokenExpiryDate":null},{"id":30,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444454,"userName":"qweqwero","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251910000,"authorities":[{"id":30,"authority":"DQS_USER"}],"tokenExpiryDate":null}],"pageable":{"sort":{"sorted":false,"unsorted":true,"empty":true},"pageNumber":2,"pageSize":10,"offset":20,"unpaged":false,"paged":true},"last":false,"totalPages":8,"totalElements":71,"sort":{"sorted":false,"unsorted":true,"empty":true},"first":false,"numberOfElements":10,"size":10,"number":2,"empty":false}');
                return of(new HttpResponse({ status: 200, body: users }));
            }
            // get user details
            if (request.url.indexOf('/api/users/find') != -1 && request.method === 'GET') {
                // check for fake auth token in header and return users if valid, this security is implemented server side in a real application
                let body = JSON.parse('{"id":22,"dateOfBirthGregorian":null,"dateOfBirthHijri":14401010,"email":"myemail@mycompany.com","familyName":"MyFamilyName","firstName":"MyFirstName","gender":"M","grandFatherName":null,"subtribeName":null,"fatherName":null,"lastLoginDate":null,"mobileNumber":555555555,"nin":1234444445,"userName":"qweqwer","avatarFile":null,"avatar":null,"numberOfTries":0,"password":"<CONFIDENTIAL>","passwordHash":"<CONFIDENTIAL>","preferredLanguage":null,"updateDate":null,"deleted":false,"activated":true,"blockDate":null,"blocked":false,"changePasswordRequired":false,"creationDate":1548251787000,"authorities":[{"id":22,"authority":"DQS_USER"}],"tokenExpiryDate":null}');
                return of(new HttpResponse({ status: 200, body: body }));
            }
            // pass through any requests not handled above
            return next.handle(request);
        }))
            // call materialize and dematerialize to ensure delay even if an error is thrown (https://github.com/Reactive-Extensions/RxJS/issues/648)
            .pipe(materialize())
            .pipe(delay(500))
            .pipe(dematerialize());
    }
};
MockInterceptor.ctorParameters = () => [
    { type: undefined, decorators: [{ type: Inject, args: ['environment',] }] }
];
MockInterceptor = __decorate([
    Injectable(),
    __param(0, Inject('environment')),
    __metadata("design:paramtypes", [Object])
], MockInterceptor);
export { MockInterceptor };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibW9jay5pbnRlcmNlcHRvci5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0BkY2MtY29tbW9ucy1uZy9zZXJ2aWNlcy8iLCJzb3VyY2VzIjpbImxpYi9odHRwL21vY2suaW50ZXJjZXB0b3IudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0dBRUc7O0FBRUgsT0FBTyxFQUFDLE1BQU0sRUFBRSxVQUFVLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFDakQsT0FBTyxFQUF1RCxZQUFZLEVBQUMsTUFBTSxzQkFBc0IsQ0FBQztBQUN4RyxPQUFPLEVBQWEsRUFBRSxFQUFDLE1BQU0sTUFBTSxDQUFDO0FBQ3BDLE9BQU8sRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFFLFdBQVcsRUFBRSxRQUFRLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUMzRSxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0sNEJBQTRCLENBQUM7QUFFbEQsTUFBTSxHQUFHLEdBQUcsSUFBSSxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztBQUcxQyxJQUFhLGVBQWUsR0FBNUIsTUFBYSxlQUFlO0lBSTFCLFlBQW1DLFdBQWdCO1FBQ2pELElBQUksQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFBO0lBQ2hDLENBQUM7SUFFRCxTQUFTLENBQUMsT0FBeUIsRUFBRSxJQUFpQjtRQUNwRCwyRUFBMkU7UUFDM0UsSUFBSSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUU7WUFDbkQsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1NBQzdCO1FBQ0QsR0FBRyxDQUFDLEtBQUssQ0FBQyxvQ0FBb0MsQ0FBQyxDQUFDO1FBRWhELDhDQUE4QztRQUM5QyxJQUFJLEtBQUssR0FBVSxJQUFJLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUMsSUFBSSxFQUFFLENBQUM7UUFFbkUseURBQXlEO1FBQ3pELE9BQU8sRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsR0FBRyxFQUFFO1lBRWpDLGVBQWU7WUFDZixJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxNQUFNLEVBQUU7Z0JBQzdFLGdGQUFnRjtnQkFDaEYsSUFBSSxJQUFJLEdBQUc7b0JBQ1QsV0FBVyxFQUFFLENBQUMsRUFBQyxXQUFXLEVBQUUsV0FBVyxFQUFDLENBQUM7b0JBQ3pDLFNBQVMsRUFBRSxPQUFPO29CQUNsQixJQUFJLEVBQUUsT0FBTztpQkFDZCxDQUFDO2dCQUVGLE9BQU8sRUFBRSxDQUFDLElBQUksWUFBWSxDQUFDLEVBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQyxDQUFDO2FBQ3hEO1lBRUQsU0FBUztZQUNULElBQUksT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsa0JBQWtCLENBQUMsSUFBSSxDQUFDLENBQUMsSUFBSSxPQUFPLENBQUMsTUFBTSxLQUFLLE1BQU0sRUFBRTtnQkFDOUUsZ0ZBQWdGO2dCQUNoRixPQUFPLEVBQUUsQ0FBQyxJQUFJLFlBQVksQ0FBQyxFQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBQyxDQUFDLENBQUMsQ0FBQzthQUMxRDtZQUVELFlBQVk7WUFDWixJQUFJLE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksT0FBTyxDQUFDLE1BQU0sS0FBSyxLQUFLLEVBQUU7Z0JBQzVFLGdJQUFnSTtnQkFDaEksS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsMnhOQUEyeE4sQ0FBQyxDQUFDO2dCQUNoek4sT0FBTyxFQUFFLENBQUMsSUFBSSxZQUFZLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDLENBQUM7YUFDekQ7WUFFRCxtQkFBbUI7WUFDbkIsSUFBSSxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxNQUFNLEtBQUssS0FBSyxFQUFFO2dCQUM1RSxnSUFBZ0k7Z0JBQ2hJLElBQUksSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsc3BCQUFzcEIsQ0FBQyxDQUFDO2dCQUM5cUIsT0FBTyxFQUFFLENBQUMsSUFBSSxZQUFZLENBQUMsRUFBQyxNQUFNLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDLENBQUM7YUFDeEQ7WUFFRCw4Q0FBOEM7WUFDOUMsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRTlCLENBQUMsQ0FBQyxDQUFDO1lBRUQseUlBQXlJO2FBQ3hJLElBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQzthQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDO2FBQ2hCLElBQUksQ0FBQyxhQUFhLEVBQUUsQ0FBQyxDQUFDO0lBQzNCLENBQUM7Q0FDRixDQUFBOzs0Q0EzRGMsTUFBTSxTQUFDLGFBQWE7O0FBSnRCLGVBQWU7SUFEM0IsVUFBVSxFQUFFO0lBS0UsV0FBQSxNQUFNLENBQUMsYUFBYSxDQUFDLENBQUE7O0dBSnZCLGVBQWUsQ0ErRDNCO1NBL0RZLGVBQWUiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChjKSAyMDE5IEVMTS4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqL1xuXG5pbXBvcnQge0luamVjdCwgSW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0h0dHBFdmVudCwgSHR0cEhhbmRsZXIsIEh0dHBJbnRlcmNlcHRvciwgSHR0cFJlcXVlc3QsIEh0dHBSZXNwb25zZX0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHtPYnNlcnZhYmxlLCBvZn0gZnJvbSAncnhqcyc7XG5pbXBvcnQge2RlbGF5LCBkZW1hdGVyaWFsaXplLCBtYXRlcmlhbGl6ZSwgbWVyZ2VNYXB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7TG9nZ2VyfSBmcm9tICcuLi9sb2dnaW5nL2xvZ2dpbmcuc2VydmljZSc7XG5cbmNvbnN0IGxvZyA9IG5ldyBMb2dnZXIoJ01vY2tJbnRlcmNlcHRvcicpO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgTW9ja0ludGVyY2VwdG9yIGltcGxlbWVudHMgSHR0cEludGVyY2VwdG9yIHtcblxuICBwcml2YXRlIGVudmlyb25tZW50OiBhbnk7XG5cbiAgY29uc3RydWN0b3IoQEluamVjdCgnZW52aXJvbm1lbnQnKSBlbnZpcm9ubWVudDogYW55KSB7XG4gICAgdGhpcy5lbnZpcm9ubWVudCA9IGVudmlyb25tZW50XG4gIH1cblxuICBpbnRlcmNlcHQocmVxdWVzdDogSHR0cFJlcXVlc3Q8YW55PiwgbmV4dDogSHR0cEhhbmRsZXIpOiBPYnNlcnZhYmxlPEh0dHBFdmVudDxhbnk+PiB7XG4gICAgLy8gaWYgbW9jayBpcyBub3QgZW5hYmxlZCBvciB3ZSBhcmUgbm90IGluIGRldiBlbnZpcm9ubWVudCwgdGhlbiBkbyBub3RoaW5nXG4gICAgaWYgKCF0aGlzLmVudmlyb25tZW50Lm1vY2sgfHwgIXRoaXMuZW52aXJvbm1lbnQuZGV2KSB7XG4gICAgICByZXR1cm4gbmV4dC5oYW5kbGUocmVxdWVzdCk7XG4gICAgfVxuICAgIGxvZy5kZWJ1ZygnIyMjIyMjIyMjIyMjIyMjIyMjIE1vY2sgaXMgZW5hYmxlZCcpO1xuXG4gICAgLy8gYXJyYXkgaW4gbG9jYWwgc3RvcmFnZSBmb3IgcmVnaXN0ZXJlZCB1c2Vyc1xuICAgIGxldCB1c2VyczogYW55W10gPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VycycpKSB8fCBbXTtcblxuICAgIC8vIHdyYXAgaW4gZGVsYXllZCBvYnNlcnZhYmxlIHRvIHNpbXVsYXRlIHNlcnZlciBhcGkgY2FsbFxuICAgIHJldHVybiBvZihudWxsKS5waXBlKG1lcmdlTWFwKCgpID0+IHtcblxuICAgICAgLy8gYXV0aGVudGljYXRlXG4gICAgICBpZiAocmVxdWVzdC51cmwuaW5kZXhPZignL2FwaS9hdXRoL2xvZ2luJykgIT0gLTEgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAvLyBpZiBsb2dpbiBkZXRhaWxzIGFyZSB2YWxpZCByZXR1cm4gMjAwIE9LIHdpdGggdXNlciBkZXRhaWxzIGFuZCBmYWtlIGp3dCB0b2tlblxuICAgICAgICBsZXQgYm9keSA9IHtcbiAgICAgICAgICBhdXRob3JpdGllczogW3tcImF1dGhvcml0eVwiOiBcIkRRU19BRE1JTlwifV0sXG4gICAgICAgICAgcHJpbmNpcGFsOiBcImFkbWluXCIsXG4gICAgICAgICAgbmFtZTogXCJhZG1pblwiXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIG9mKG5ldyBIdHRwUmVzcG9uc2Uoe3N0YXR1czogMjAwLCBib2R5OiBib2R5fSkpO1xuICAgICAgfVxuXG4gICAgICAvLyBsb2dvdXRcbiAgICAgIGlmIChyZXF1ZXN0LnVybC5pbmRleE9mKCcvYXBpL2F1dGgvbG9nb3V0JykgIT0gLTEgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdQT1NUJykge1xuICAgICAgICAvLyBpZiBsb2dpbiBkZXRhaWxzIGFyZSB2YWxpZCByZXR1cm4gMjAwIE9LIHdpdGggdXNlciBkZXRhaWxzIGFuZCBmYWtlIGp3dCB0b2tlblxuICAgICAgICByZXR1cm4gb2YobmV3IEh0dHBSZXNwb25zZSh7c3RhdHVzOiAyMDAsIGJvZHk6ICd0cnVlJ30pKTtcbiAgICAgIH1cblxuICAgICAgLy8gZ2V0IHVzZXJzXG4gICAgICBpZiAocmVxdWVzdC51cmwuaW5kZXhPZignL2FwaS91c2Vycy9saXN0JykgIT0gLTEgJiYgcmVxdWVzdC5tZXRob2QgPT09ICdHRVQnKSB7XG4gICAgICAgIC8vIGNoZWNrIGZvciBmYWtlIGF1dGggdG9rZW4gaW4gaGVhZGVyIGFuZCByZXR1cm4gdXNlcnMgaWYgdmFsaWQsIHRoaXMgc2VjdXJpdHkgaXMgaW1wbGVtZW50ZWQgc2VydmVyIHNpZGUgaW4gYSByZWFsIGFwcGxpY2F0aW9uXG4gICAgICAgIHVzZXJzID0gSlNPTi5wYXJzZSgne1wiY29udGVudFwiOlt7XCJpZFwiOjIxLFwiZGF0ZU9mQmlydGhHcmVnb3JpYW5cIjpudWxsLFwiZGF0ZU9mQmlydGhIaWpyaVwiOjE0NDAxMDEwLFwiZW1haWxcIjpcIm15ZW1haWxAbXljb21wYW55LmNvbVwiLFwiZmFtaWx5TmFtZVwiOlwiTXlGYW1pbHlOYW1lXCIsXCJmaXJzdE5hbWVcIjpcIk15Rmlyc3ROYW1lXCIsXCJnZW5kZXJcIjpcIk1cIixcImdyYW5kRmF0aGVyTmFtZVwiOm51bGwsXCJzdWJ0cmliZU5hbWVcIjpudWxsLFwiZmF0aGVyTmFtZVwiOm51bGwsXCJsYXN0TG9naW5EYXRlXCI6bnVsbCxcIm1vYmlsZU51bWJlclwiOjU1NTU1NTU1NSxcIm5pblwiOjEyMzQ0NDQ0NDQsXCJ1c2VyTmFtZVwiOlwicXdlcXdlXCIsXCJhdmF0YXJGaWxlXCI6bnVsbCxcImF2YXRhclwiOm51bGwsXCJudW1iZXJPZlRyaWVzXCI6MCxcInBhc3N3b3JkXCI6XCI8Q09ORklERU5USUFMPlwiLFwicGFzc3dvcmRIYXNoXCI6XCI8Q09ORklERU5USUFMPlwiLFwicHJlZmVycmVkTGFuZ3VhZ2VcIjpudWxsLFwidXBkYXRlRGF0ZVwiOm51bGwsXCJkZWxldGVkXCI6ZmFsc2UsXCJhY3RpdmF0ZWRcIjp0cnVlLFwiYmxvY2tEYXRlXCI6bnVsbCxcImJsb2NrZWRcIjpmYWxzZSxcImNoYW5nZVBhc3N3b3JkUmVxdWlyZWRcIjpmYWxzZSxcImNyZWF0aW9uRGF0ZVwiOjE1NDgyNTE3NjcwMDAsXCJhdXRob3JpdGllc1wiOlt7XCJpZFwiOjIxLFwiYXV0aG9yaXR5XCI6XCJEUVNfVVNFUlwifV0sXCJ0b2tlbkV4cGlyeURhdGVcIjpudWxsfSx7XCJpZFwiOjIyLFwiZGF0ZU9mQmlydGhHcmVnb3JpYW5cIjpudWxsLFwiZGF0ZU9mQmlydGhIaWpyaVwiOjE0NDAxMDEwLFwiZW1haWxcIjpcIm15ZW1haWxAbXljb21wYW55LmNvbVwiLFwiZmFtaWx5TmFtZVwiOlwiTXlGYW1pbHlOYW1lXCIsXCJmaXJzdE5hbWVcIjpcIk15Rmlyc3ROYW1lXCIsXCJnZW5kZXJcIjpcIk1cIixcImdyYW5kRmF0aGVyTmFtZVwiOm51bGwsXCJzdWJ0cmliZU5hbWVcIjpudWxsLFwiZmF0aGVyTmFtZVwiOm51bGwsXCJsYXN0TG9naW5EYXRlXCI6bnVsbCxcIm1vYmlsZU51bWJlclwiOjU1NTU1NTU1NSxcIm5pblwiOjEyMzQ0NDQ0NDUsXCJ1c2VyTmFtZVwiOlwicXdlcXdlclwiLFwiYXZhdGFyRmlsZVwiOm51bGwsXCJhdmF0YXJcIjpudWxsLFwibnVtYmVyT2ZUcmllc1wiOjAsXCJwYXNzd29yZFwiOlwiPENPTkZJREVOVElBTD5cIixcInBhc3N3b3JkSGFzaFwiOlwiPENPTkZJREVOVElBTD5cIixcInByZWZlcnJlZExhbmd1YWdlXCI6bnVsbCxcInVwZGF0ZURhdGVcIjpudWxsLFwiZGVsZXRlZFwiOmZhbHNlLFwiYWN0aXZhdGVkXCI6dHJ1ZSxcImJsb2NrRGF0ZVwiOm51bGwsXCJibG9ja2VkXCI6ZmFsc2UsXCJjaGFuZ2VQYXNzd29yZFJlcXVpcmVkXCI6ZmFsc2UsXCJjcmVhdGlvbkRhdGVcIjoxNTQ4MjUxNzg3MDAwLFwiYXV0aG9yaXRpZXNcIjpbe1wiaWRcIjoyMixcImF1dGhvcml0eVwiOlwiRFFTX1VTRVJcIn1dLFwidG9rZW5FeHBpcnlEYXRlXCI6bnVsbH0se1wiaWRcIjoyMyxcImRhdGVPZkJpcnRoR3JlZ29yaWFuXCI6bnVsbCxcImRhdGVPZkJpcnRoSGlqcmlcIjoxNDQwMTAxMCxcImVtYWlsXCI6XCJteWVtYWlsQG15Y29tcGFueS5jb21cIixcImZhbWlseU5hbWVcIjpcIk15RmFtaWx5TmFtZVwiLFwiZmlyc3ROYW1lXCI6XCJNeUZpcnN0TmFtZVwiLFwiZ2VuZGVyXCI6XCJNXCIsXCJncmFuZEZhdGhlck5hbWVcIjpudWxsLFwic3VidHJpYmVOYW1lXCI6bnVsbCxcImZhdGhlck5hbWVcIjpudWxsLFwibGFzdExvZ2luRGF0ZVwiOm51bGwsXCJtb2JpbGVOdW1iZXJcIjo1NTU1NTU1NTUsXCJuaW5cIjoxMjM0NDQ0NDQ2LFwidXNlck5hbWVcIjpcInF3ZXF3ZXJxXCIsXCJhdmF0YXJGaWxlXCI6bnVsbCxcImF2YXRhclwiOm51bGwsXCJudW1iZXJPZlRyaWVzXCI6MCxcInBhc3N3b3JkXCI6XCI8Q09ORklERU5USUFMPlwiLFwicGFzc3dvcmRIYXNoXCI6XCI8Q09ORklERU5USUFMPlwiLFwicHJlZmVycmVkTGFuZ3VhZ2VcIjpudWxsLFwidXBkYXRlRGF0ZVwiOm51bGwsXCJkZWxldGVkXCI6ZmFsc2UsXCJhY3RpdmF0ZWRcIjp0cnVlLFwiYmxvY2tEYXRlXCI6bnVsbCxcImJsb2NrZWRcIjpmYWxzZSxcImNoYW5nZVBhc3N3b3JkUmVxdWlyZWRcIjpmYWxzZSxcImNyZWF0aW9uRGF0ZVwiOjE1NDgyNTE5MDgwMDAsXCJhdXRob3JpdGllc1wiOlt7XCJpZFwiOjIzLFwiYXV0aG9yaXR5XCI6XCJEUVNfVVNFUlwifV0sXCJ0b2tlbkV4cGlyeURhdGVcIjpudWxsfSx7XCJpZFwiOjI0LFwiZGF0ZU9mQmlydGhHcmVnb3JpYW5cIjpudWxsLFwiZGF0ZU9mQmlydGhIaWpyaVwiOjE0NDAxMDEwLFwiZW1haWxcIjpcIm15ZW1haWxAbXljb21wYW55LmNvbVwiLFwiZmFtaWx5TmFtZVwiOlwiTXlGYW1pbHlOYW1lXCIsXCJmaXJzdE5hbWVcIjpcIk15Rmlyc3ROYW1lXCIsXCJnZW5kZXJcIjpcIk1cIixcImdyYW5kRmF0aGVyTmFtZVwiOm51bGwsXCJzdWJ0cmliZU5hbWVcIjpudWxsLFwiZmF0aGVyTmFtZVwiOm51bGwsXCJsYXN0TG9naW5EYXRlXCI6bnVsbCxcIm1vYmlsZU51bWJlclwiOjU1NTU1NTU1NSxcIm5pblwiOjEyMzQ0NDQ0NDcsXCJ1c2VyTmFtZVwiOlwicXdlcXdlcndcIixcImF2YXRhckZpbGVcIjpudWxsLFwiYXZhdGFyXCI6bnVsbCxcIm51bWJlck9mVHJpZXNcIjowLFwicGFzc3dvcmRcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwYXNzd29yZEhhc2hcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwcmVmZXJyZWRMYW5ndWFnZVwiOm51bGwsXCJ1cGRhdGVEYXRlXCI6bnVsbCxcImRlbGV0ZWRcIjpmYWxzZSxcImFjdGl2YXRlZFwiOnRydWUsXCJibG9ja0RhdGVcIjpudWxsLFwiYmxvY2tlZFwiOmZhbHNlLFwiY2hhbmdlUGFzc3dvcmRSZXF1aXJlZFwiOmZhbHNlLFwiY3JlYXRpb25EYXRlXCI6MTU0ODI1MTkwOTAwMCxcImF1dGhvcml0aWVzXCI6W3tcImlkXCI6MjQsXCJhdXRob3JpdHlcIjpcIkRRU19VU0VSXCJ9XSxcInRva2VuRXhwaXJ5RGF0ZVwiOm51bGx9LHtcImlkXCI6MjUsXCJkYXRlT2ZCaXJ0aEdyZWdvcmlhblwiOm51bGwsXCJkYXRlT2ZCaXJ0aEhpanJpXCI6MTQ0MDEwMTAsXCJlbWFpbFwiOlwibXllbWFpbEBteWNvbXBhbnkuY29tXCIsXCJmYW1pbHlOYW1lXCI6XCJNeUZhbWlseU5hbWVcIixcImZpcnN0TmFtZVwiOlwiTXlGaXJzdE5hbWVcIixcImdlbmRlclwiOlwiTVwiLFwiZ3JhbmRGYXRoZXJOYW1lXCI6bnVsbCxcInN1YnRyaWJlTmFtZVwiOm51bGwsXCJmYXRoZXJOYW1lXCI6bnVsbCxcImxhc3RMb2dpbkRhdGVcIjpudWxsLFwibW9iaWxlTnVtYmVyXCI6NTU1NTU1NTU1LFwibmluXCI6MTIzNDQ0NDQ0OCxcInVzZXJOYW1lXCI6XCJxd2Vxd2VyZVwiLFwiYXZhdGFyRmlsZVwiOm51bGwsXCJhdmF0YXJcIjpudWxsLFwibnVtYmVyT2ZUcmllc1wiOjAsXCJwYXNzd29yZFwiOlwiPENPTkZJREVOVElBTD5cIixcInBhc3N3b3JkSGFzaFwiOlwiPENPTkZJREVOVElBTD5cIixcInByZWZlcnJlZExhbmd1YWdlXCI6bnVsbCxcInVwZGF0ZURhdGVcIjpudWxsLFwiZGVsZXRlZFwiOmZhbHNlLFwiYWN0aXZhdGVkXCI6dHJ1ZSxcImJsb2NrRGF0ZVwiOm51bGwsXCJibG9ja2VkXCI6ZmFsc2UsXCJjaGFuZ2VQYXNzd29yZFJlcXVpcmVkXCI6ZmFsc2UsXCJjcmVhdGlvbkRhdGVcIjoxNTQ4MjUxOTA5MDAwLFwiYXV0aG9yaXRpZXNcIjpbe1wiaWRcIjoyNSxcImF1dGhvcml0eVwiOlwiRFFTX1VTRVJcIn1dLFwidG9rZW5FeHBpcnlEYXRlXCI6bnVsbH0se1wiaWRcIjoyNixcImRhdGVPZkJpcnRoR3JlZ29yaWFuXCI6bnVsbCxcImRhdGVPZkJpcnRoSGlqcmlcIjoxNDQwMTAxMCxcImVtYWlsXCI6XCJteWVtYWlsQG15Y29tcGFueS5jb21cIixcImZhbWlseU5hbWVcIjpcIk15RmFtaWx5TmFtZVwiLFwiZmlyc3ROYW1lXCI6XCJNeUZpcnN0TmFtZVwiLFwiZ2VuZGVyXCI6XCJNXCIsXCJncmFuZEZhdGhlck5hbWVcIjpudWxsLFwic3VidHJpYmVOYW1lXCI6bnVsbCxcImZhdGhlck5hbWVcIjpudWxsLFwibGFzdExvZ2luRGF0ZVwiOm51bGwsXCJtb2JpbGVOdW1iZXJcIjo1NTU1NTU1NTUsXCJuaW5cIjoxMjM0NDQ0NDQ5LFwidXNlck5hbWVcIjpcInF3ZXF3ZXJyXCIsXCJhdmF0YXJGaWxlXCI6bnVsbCxcImF2YXRhclwiOm51bGwsXCJudW1iZXJPZlRyaWVzXCI6MCxcInBhc3N3b3JkXCI6XCI8Q09ORklERU5USUFMPlwiLFwicGFzc3dvcmRIYXNoXCI6XCI8Q09ORklERU5USUFMPlwiLFwicHJlZmVycmVkTGFuZ3VhZ2VcIjpudWxsLFwidXBkYXRlRGF0ZVwiOm51bGwsXCJkZWxldGVkXCI6ZmFsc2UsXCJhY3RpdmF0ZWRcIjp0cnVlLFwiYmxvY2tEYXRlXCI6bnVsbCxcImJsb2NrZWRcIjpmYWxzZSxcImNoYW5nZVBhc3N3b3JkUmVxdWlyZWRcIjpmYWxzZSxcImNyZWF0aW9uRGF0ZVwiOjE1NDgyNTE5MDkwMDAsXCJhdXRob3JpdGllc1wiOlt7XCJpZFwiOjI2LFwiYXV0aG9yaXR5XCI6XCJEUVNfVVNFUlwifV0sXCJ0b2tlbkV4cGlyeURhdGVcIjpudWxsfSx7XCJpZFwiOjI3LFwiZGF0ZU9mQmlydGhHcmVnb3JpYW5cIjpudWxsLFwiZGF0ZU9mQmlydGhIaWpyaVwiOjE0NDAxMDEwLFwiZW1haWxcIjpcIm15ZW1haWxAbXljb21wYW55LmNvbVwiLFwiZmFtaWx5TmFtZVwiOlwiTXlGYW1pbHlOYW1lXCIsXCJmaXJzdE5hbWVcIjpcIk15Rmlyc3ROYW1lXCIsXCJnZW5kZXJcIjpcIk1cIixcImdyYW5kRmF0aGVyTmFtZVwiOm51bGwsXCJzdWJ0cmliZU5hbWVcIjpudWxsLFwiZmF0aGVyTmFtZVwiOm51bGwsXCJsYXN0TG9naW5EYXRlXCI6bnVsbCxcIm1vYmlsZU51bWJlclwiOjU1NTU1NTU1NSxcIm5pblwiOjEyMzQ0NDQ0NTAsXCJ1c2VyTmFtZVwiOlwicXdlcXdlcnRcIixcImF2YXRhckZpbGVcIjpudWxsLFwiYXZhdGFyXCI6bnVsbCxcIm51bWJlck9mVHJpZXNcIjowLFwicGFzc3dvcmRcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwYXNzd29yZEhhc2hcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwcmVmZXJyZWRMYW5ndWFnZVwiOm51bGwsXCJ1cGRhdGVEYXRlXCI6bnVsbCxcImRlbGV0ZWRcIjpmYWxzZSxcImFjdGl2YXRlZFwiOnRydWUsXCJibG9ja0RhdGVcIjpudWxsLFwiYmxvY2tlZFwiOmZhbHNlLFwiY2hhbmdlUGFzc3dvcmRSZXF1aXJlZFwiOmZhbHNlLFwiY3JlYXRpb25EYXRlXCI6MTU0ODI1MTkwOTAwMCxcImF1dGhvcml0aWVzXCI6W3tcImlkXCI6MjcsXCJhdXRob3JpdHlcIjpcIkRRU19VU0VSXCJ9XSxcInRva2VuRXhwaXJ5RGF0ZVwiOm51bGx9LHtcImlkXCI6MjgsXCJkYXRlT2ZCaXJ0aEdyZWdvcmlhblwiOm51bGwsXCJkYXRlT2ZCaXJ0aEhpanJpXCI6MTQ0MDEwMTAsXCJlbWFpbFwiOlwibXllbWFpbEBteWNvbXBhbnkuY29tXCIsXCJmYW1pbHlOYW1lXCI6XCJNeUZhbWlseU5hbWVcIixcImZpcnN0TmFtZVwiOlwiTXlGaXJzdE5hbWVcIixcImdlbmRlclwiOlwiTVwiLFwiZ3JhbmRGYXRoZXJOYW1lXCI6bnVsbCxcInN1YnRyaWJlTmFtZVwiOm51bGwsXCJmYXRoZXJOYW1lXCI6bnVsbCxcImxhc3RMb2dpbkRhdGVcIjpudWxsLFwibW9iaWxlTnVtYmVyXCI6NTU1NTU1NTU1LFwibmluXCI6MTIzNDQ0NDQ1MixcInVzZXJOYW1lXCI6XCJxd2Vxd2VydVwiLFwiYXZhdGFyRmlsZVwiOm51bGwsXCJhdmF0YXJcIjpudWxsLFwibnVtYmVyT2ZUcmllc1wiOjAsXCJwYXNzd29yZFwiOlwiPENPTkZJREVOVElBTD5cIixcInBhc3N3b3JkSGFzaFwiOlwiPENPTkZJREVOVElBTD5cIixcInByZWZlcnJlZExhbmd1YWdlXCI6bnVsbCxcInVwZGF0ZURhdGVcIjpudWxsLFwiZGVsZXRlZFwiOmZhbHNlLFwiYWN0aXZhdGVkXCI6dHJ1ZSxcImJsb2NrRGF0ZVwiOm51bGwsXCJibG9ja2VkXCI6ZmFsc2UsXCJjaGFuZ2VQYXNzd29yZFJlcXVpcmVkXCI6ZmFsc2UsXCJjcmVhdGlvbkRhdGVcIjoxNTQ4MjUxOTEwMDAwLFwiYXV0aG9yaXRpZXNcIjpbe1wiaWRcIjoyOCxcImF1dGhvcml0eVwiOlwiRFFTX1VTRVJcIn1dLFwidG9rZW5FeHBpcnlEYXRlXCI6bnVsbH0se1wiaWRcIjoyOSxcImRhdGVPZkJpcnRoR3JlZ29yaWFuXCI6bnVsbCxcImRhdGVPZkJpcnRoSGlqcmlcIjoxNDQwMTAxMCxcImVtYWlsXCI6XCJteWVtYWlsQG15Y29tcGFueS5jb21cIixcImZhbWlseU5hbWVcIjpcIk15RmFtaWx5TmFtZVwiLFwiZmlyc3ROYW1lXCI6XCJNeUZpcnN0TmFtZVwiLFwiZ2VuZGVyXCI6XCJNXCIsXCJncmFuZEZhdGhlck5hbWVcIjpudWxsLFwic3VidHJpYmVOYW1lXCI6bnVsbCxcImZhdGhlck5hbWVcIjpudWxsLFwibGFzdExvZ2luRGF0ZVwiOm51bGwsXCJtb2JpbGVOdW1iZXJcIjo1NTU1NTU1NTUsXCJuaW5cIjoxMjM0NDQ0NDUxLFwidXNlck5hbWVcIjpcInF3ZXF3ZXJ5XCIsXCJhdmF0YXJGaWxlXCI6bnVsbCxcImF2YXRhclwiOm51bGwsXCJudW1iZXJPZlRyaWVzXCI6MCxcInBhc3N3b3JkXCI6XCI8Q09ORklERU5USUFMPlwiLFwicGFzc3dvcmRIYXNoXCI6XCI8Q09ORklERU5USUFMPlwiLFwicHJlZmVycmVkTGFuZ3VhZ2VcIjpudWxsLFwidXBkYXRlRGF0ZVwiOm51bGwsXCJkZWxldGVkXCI6ZmFsc2UsXCJhY3RpdmF0ZWRcIjp0cnVlLFwiYmxvY2tEYXRlXCI6bnVsbCxcImJsb2NrZWRcIjpmYWxzZSxcImNoYW5nZVBhc3N3b3JkUmVxdWlyZWRcIjpmYWxzZSxcImNyZWF0aW9uRGF0ZVwiOjE1NDgyNTE5MTAwMDAsXCJhdXRob3JpdGllc1wiOlt7XCJpZFwiOjI5LFwiYXV0aG9yaXR5XCI6XCJEUVNfVVNFUlwifV0sXCJ0b2tlbkV4cGlyeURhdGVcIjpudWxsfSx7XCJpZFwiOjMwLFwiZGF0ZU9mQmlydGhHcmVnb3JpYW5cIjpudWxsLFwiZGF0ZU9mQmlydGhIaWpyaVwiOjE0NDAxMDEwLFwiZW1haWxcIjpcIm15ZW1haWxAbXljb21wYW55LmNvbVwiLFwiZmFtaWx5TmFtZVwiOlwiTXlGYW1pbHlOYW1lXCIsXCJmaXJzdE5hbWVcIjpcIk15Rmlyc3ROYW1lXCIsXCJnZW5kZXJcIjpcIk1cIixcImdyYW5kRmF0aGVyTmFtZVwiOm51bGwsXCJzdWJ0cmliZU5hbWVcIjpudWxsLFwiZmF0aGVyTmFtZVwiOm51bGwsXCJsYXN0TG9naW5EYXRlXCI6bnVsbCxcIm1vYmlsZU51bWJlclwiOjU1NTU1NTU1NSxcIm5pblwiOjEyMzQ0NDQ0NTQsXCJ1c2VyTmFtZVwiOlwicXdlcXdlcm9cIixcImF2YXRhckZpbGVcIjpudWxsLFwiYXZhdGFyXCI6bnVsbCxcIm51bWJlck9mVHJpZXNcIjowLFwicGFzc3dvcmRcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwYXNzd29yZEhhc2hcIjpcIjxDT05GSURFTlRJQUw+XCIsXCJwcmVmZXJyZWRMYW5ndWFnZVwiOm51bGwsXCJ1cGRhdGVEYXRlXCI6bnVsbCxcImRlbGV0ZWRcIjpmYWxzZSxcImFjdGl2YXRlZFwiOnRydWUsXCJibG9ja0RhdGVcIjpudWxsLFwiYmxvY2tlZFwiOmZhbHNlLFwiY2hhbmdlUGFzc3dvcmRSZXF1aXJlZFwiOmZhbHNlLFwiY3JlYXRpb25EYXRlXCI6MTU0ODI1MTkxMDAwMCxcImF1dGhvcml0aWVzXCI6W3tcImlkXCI6MzAsXCJhdXRob3JpdHlcIjpcIkRRU19VU0VSXCJ9XSxcInRva2VuRXhwaXJ5RGF0ZVwiOm51bGx9XSxcInBhZ2VhYmxlXCI6e1wic29ydFwiOntcInNvcnRlZFwiOmZhbHNlLFwidW5zb3J0ZWRcIjp0cnVlLFwiZW1wdHlcIjp0cnVlfSxcInBhZ2VOdW1iZXJcIjoyLFwicGFnZVNpemVcIjoxMCxcIm9mZnNldFwiOjIwLFwidW5wYWdlZFwiOmZhbHNlLFwicGFnZWRcIjp0cnVlfSxcImxhc3RcIjpmYWxzZSxcInRvdGFsUGFnZXNcIjo4LFwidG90YWxFbGVtZW50c1wiOjcxLFwic29ydFwiOntcInNvcnRlZFwiOmZhbHNlLFwidW5zb3J0ZWRcIjp0cnVlLFwiZW1wdHlcIjp0cnVlfSxcImZpcnN0XCI6ZmFsc2UsXCJudW1iZXJPZkVsZW1lbnRzXCI6MTAsXCJzaXplXCI6MTAsXCJudW1iZXJcIjoyLFwiZW1wdHlcIjpmYWxzZX0nKTtcbiAgICAgICAgcmV0dXJuIG9mKG5ldyBIdHRwUmVzcG9uc2Uoe3N0YXR1czogMjAwLCBib2R5OiB1c2Vyc30pKTtcbiAgICAgIH1cblxuICAgICAgLy8gZ2V0IHVzZXIgZGV0YWlsc1xuICAgICAgaWYgKHJlcXVlc3QudXJsLmluZGV4T2YoJy9hcGkvdXNlcnMvZmluZCcpICE9IC0xICYmIHJlcXVlc3QubWV0aG9kID09PSAnR0VUJykge1xuICAgICAgICAvLyBjaGVjayBmb3IgZmFrZSBhdXRoIHRva2VuIGluIGhlYWRlciBhbmQgcmV0dXJuIHVzZXJzIGlmIHZhbGlkLCB0aGlzIHNlY3VyaXR5IGlzIGltcGxlbWVudGVkIHNlcnZlciBzaWRlIGluIGEgcmVhbCBhcHBsaWNhdGlvblxuICAgICAgICBsZXQgYm9keSA9IEpTT04ucGFyc2UoJ3tcImlkXCI6MjIsXCJkYXRlT2ZCaXJ0aEdyZWdvcmlhblwiOm51bGwsXCJkYXRlT2ZCaXJ0aEhpanJpXCI6MTQ0MDEwMTAsXCJlbWFpbFwiOlwibXllbWFpbEBteWNvbXBhbnkuY29tXCIsXCJmYW1pbHlOYW1lXCI6XCJNeUZhbWlseU5hbWVcIixcImZpcnN0TmFtZVwiOlwiTXlGaXJzdE5hbWVcIixcImdlbmRlclwiOlwiTVwiLFwiZ3JhbmRGYXRoZXJOYW1lXCI6bnVsbCxcInN1YnRyaWJlTmFtZVwiOm51bGwsXCJmYXRoZXJOYW1lXCI6bnVsbCxcImxhc3RMb2dpbkRhdGVcIjpudWxsLFwibW9iaWxlTnVtYmVyXCI6NTU1NTU1NTU1LFwibmluXCI6MTIzNDQ0NDQ0NSxcInVzZXJOYW1lXCI6XCJxd2Vxd2VyXCIsXCJhdmF0YXJGaWxlXCI6bnVsbCxcImF2YXRhclwiOm51bGwsXCJudW1iZXJPZlRyaWVzXCI6MCxcInBhc3N3b3JkXCI6XCI8Q09ORklERU5USUFMPlwiLFwicGFzc3dvcmRIYXNoXCI6XCI8Q09ORklERU5USUFMPlwiLFwicHJlZmVycmVkTGFuZ3VhZ2VcIjpudWxsLFwidXBkYXRlRGF0ZVwiOm51bGwsXCJkZWxldGVkXCI6ZmFsc2UsXCJhY3RpdmF0ZWRcIjp0cnVlLFwiYmxvY2tEYXRlXCI6bnVsbCxcImJsb2NrZWRcIjpmYWxzZSxcImNoYW5nZVBhc3N3b3JkUmVxdWlyZWRcIjpmYWxzZSxcImNyZWF0aW9uRGF0ZVwiOjE1NDgyNTE3ODcwMDAsXCJhdXRob3JpdGllc1wiOlt7XCJpZFwiOjIyLFwiYXV0aG9yaXR5XCI6XCJEUVNfVVNFUlwifV0sXCJ0b2tlbkV4cGlyeURhdGVcIjpudWxsfScpO1xuICAgICAgICByZXR1cm4gb2YobmV3IEh0dHBSZXNwb25zZSh7c3RhdHVzOiAyMDAsIGJvZHk6IGJvZHl9KSk7XG4gICAgICB9XG5cbiAgICAgIC8vIHBhc3MgdGhyb3VnaCBhbnkgcmVxdWVzdHMgbm90IGhhbmRsZWQgYWJvdmVcbiAgICAgIHJldHVybiBuZXh0LmhhbmRsZShyZXF1ZXN0KTtcblxuICAgIH0pKVxuXG4gICAgICAvLyBjYWxsIG1hdGVyaWFsaXplIGFuZCBkZW1hdGVyaWFsaXplIHRvIGVuc3VyZSBkZWxheSBldmVuIGlmIGFuIGVycm9yIGlzIHRocm93biAoaHR0cHM6Ly9naXRodWIuY29tL1JlYWN0aXZlLUV4dGVuc2lvbnMvUnhKUy9pc3N1ZXMvNjQ4KVxuICAgICAgLnBpcGUobWF0ZXJpYWxpemUoKSlcbiAgICAgIC5waXBlKGRlbGF5KDUwMCkpXG4gICAgICAucGlwZShkZW1hdGVyaWFsaXplKCkpO1xuICB9XG59XG4iXX0=